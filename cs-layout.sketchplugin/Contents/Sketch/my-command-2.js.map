{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/my-command-2.js","webpack://exports/external \"sketch\""],"names":["bottom","margin","lastLayerIsText","baselineOffset","capHeightRatio","baselineOffsetRatio","capHeightOffsetRatio","context","doc","Sketch","fromNative","document","layers","selectedLayers","isArtboard","type","UI","message","artboard","iterateLayers","reverse","i","length","layer","setMargin","checkIfTop","place","isGroup","checkIfGroup","setDefaults","groupLayers","adjustToFit","checkIfText","setBottom","roundToNearest","value","near","getMargin","name","marginString","split","Number","isText","frame","y","height","capHeightOffset","getCapHeightOffset","fontSize","style","capHeight","baseline","lineHeight","Math","round","offset","diff","position","includes"],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAEA,IAAIA,MAAM,GAAG,CAAb;AAAA,IAAgBC,MAAM,GAAG,CAAzB;AAEA,IAAIC,eAAe,GAAG,KAAtB;AACA,IAAIC,cAAc,GAAG,CAArB;AAEA,IAAMC,cAAc,GAAG,GAAvB;AACA,IAAMC,mBAAmB,GAAG,IAA5B;AACA,IAAMC,oBAAoB,GAAG,IAA7B,C,CAEA;;AACe,yEAACC,OAAD,EAAa;AAC1B,MAAIC,GAAG,GAAGC,6CAAM,CAACC,UAAP,CAAkBH,OAAO,CAACI,QAA1B,CAAV;AACA,MAAIC,MAAM,GAAGJ,GAAG,GAAGA,GAAG,CAACK,cAAP,GAAwB,IAAxC;AACAD,QAAM,GAAGA,MAAM,GAAGA,MAAM,CAACA,MAAV,GAAmB,IAAlC,CAH0B,CAK1B;;AACA,MAAME,UAAU,GAAGF,MAAM,IAAIA,MAAM,CAAC,CAAD,CAAhB,IAAuBA,MAAM,CAAC,CAAD,CAAN,CAAUG,IAAjC,IAAyCH,MAAM,CAAC,CAAD,CAAN,CAAUG,IAAV,IAAkB,UAA3D,GAAwE,IAAxE,GAA+E,KAAlG;;AAEA,MAAI,CAACD,UAAL,EAAiB;AACfL,iDAAM,CAACO,EAAP,CAAUC,OAAV,CAAkB,2BAAlB;AACA;AACD,GAXyB,CAa1B;;;AACA,MAAMC,QAAQ,GAAGN,MAAM,CAAC,CAAD,CAAvB;AACAA,QAAM,GAAGM,QAAQ,CAACN,MAAlB;AAEAO,eAAa,CAACP,MAAD,CAAb,CAjB0B,CAmB1B;AAED,CArBD,E,CAwBA;;AACA,IAAMO,aAAa,GAAG,SAAhBA,aAAgB,CAACP,MAAD,EAAY;AAEhCA,QAAM,CAACQ,OAAP;AAEA,MAAIC,CAAC,GAAG,CAAR;;AAEA,SAAOA,CAAC,GAAGT,MAAM,CAACU,MAAlB,EAA0B;AAExB,QAAIC,KAAK,GAAGX,MAAM,CAACS,CAAD,CAAlB;AAEAG,aAAS,CAACD,KAAD,CAAT;AACAE,cAAU,CAACF,KAAD,CAAV;AACAG,SAAK,CAACH,KAAD,CAAL;AAEA,QAAII,OAAO,GAAGC,YAAY,CAACL,KAAD,CAA1B;;AAEA,QAAII,OAAJ,EAAa;AACXE,iBAAW;AACX,UAAIC,WAAW,GAAGP,KAAK,CAACX,MAAxB;AACAO,mBAAa,CAACW,WAAD,CAAb;AACAP,WAAK,CAACQ,WAAN;AACD;;AAED,QAAIC,WAAW,CAACT,KAAD,CAAf,EAAwB;AACtBrB,qBAAe,GAAG,IAAlB;AACD,KAFD,MAEO,IAAI0B,YAAY,CAACL,KAAD,CAAhB,EAAyB;AAC9BrB,qBAAe,GAAGA,eAAlB;AACD,KAFM,MAEA;AACLA,qBAAe,GAAG,KAAlB;AACD;;AAED+B,aAAS,CAACV,KAAD,EAAQrB,eAAR,CAAT;AAEAmB,KAAC;AAEF;;AAEDT,QAAM,CAACQ,OAAP;AAED,CAvCD;;AAyCA,IAAMc,cAAc,GAAG,SAAjBA,cAAiB,CAACC,KAAD,EAAQC,IAAR,EAAiB;AACtC,MAAID,KAAK,GAAGC,IAAR,GAAe,CAAnB,EAAsB;AACpB,WAAOD,KAAK,IAAIC,IAAI,GAAID,KAAK,GAAGC,IAApB,CAAL,GAAkCA,IAAzC;AACD,GAFD,MAEO;AACL,WAAOD,KAAK,IAAIC,IAAI,GAAID,KAAK,GAAGC,IAApB,CAAZ;AACD;AACF,CAND,C,CAQA;;;AACA,IAAMZ,SAAS,GAAG,SAAZA,SAAY,CAACD,KAAD,EAAW;AAC3BtB,QAAM,GAAGoC,SAAS,CAACd,KAAK,CAACe,IAAP,CAAlB;AACD,CAFD;;AAIA,IAAMD,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD,EAAU;AAC1B,MAAIC,YAAY,GAAGD,IAAI,CAACE,KAAL,CAAW,UAAX,EAAuB,CAAvB,CAAnB;AACAD,cAAY,GAAGA,YAAY,GAAGA,YAAY,CAACC,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAH,GAAgC,IAA3D;AACA,SAAOC,MAAM,CAACF,YAAD,CAAN,GAAuBE,MAAM,CAACF,YAAD,CAA7B,GAA8C,CAArD;AACD,CAJD,C,CAMA;;;AACA,IAAMN,SAAS,GAAG,SAAZA,SAAY,CAACV,KAAD,EAAQmB,MAAR,EAAmB;AAEnC1C,QAAM,GAAGuB,KAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBrB,KAAK,CAACoB,KAAN,CAAYE,MAArC;;AAEA,MAAIb,WAAW,CAACT,KAAD,CAAf,EAAwB;AACtB,QAAIuB,eAAe,GAAGC,kBAAkB,CAACxB,KAAD,CAAxC;AACA,QAAIyB,QAAQ,GAAGzB,KAAK,CAAC0B,KAAN,CAAYD,QAA3B;AACA,QAAIE,SAAS,GAAGF,QAAQ,GAAG5C,cAA3B;AACA,QAAI+C,QAAQ,GAAGL,eAAe,GAAGI,SAAjC;AACA/C,kBAAc,GAAGoB,KAAK,CAAC0B,KAAN,CAAYG,UAAZ,GAAyBC,IAAI,CAACC,KAAL,CAAWH,QAAX,CAA1C;AACD,GAND,MAMO,IAAIT,MAAJ,EAAY;AACjBvC,kBAAc,GAAGA,cAAjB;AACD,GAFM,MAEA;AACLH,UAAM,GAAGuB,KAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBrB,KAAK,CAACoB,KAAN,CAAYE,MAArC;AACA1C,kBAAc,GAAG,CAAjB;AACD;AAEF,CAjBD;;AAmBA,IAAM4C,kBAAkB,GAAG,SAArBA,kBAAqB,CAACxB,KAAD,EAAW;AACpC,MAAIgC,MAAJ;AAEA,MAAIP,QAAQ,GAAGzB,KAAK,CAAC0B,KAAN,CAAYD,QAA3B;AACA,MAAII,UAAU,GAAG7B,KAAK,CAAC0B,KAAN,CAAYG,UAA7B;AAEA,MAAII,IAAI,GAAGJ,UAAU,GAAGJ,QAAxB;;AACA,MAAIQ,IAAI,GAAC,CAAL,IAAU,CAAd,EAAiB;AACfD,UAAM,GAAGC,IAAI,GAAC,CAAd;AACD,GAFD,MAEO;AACLD,UAAM,GAAG,CAACC,IAAI,GAAC,CAAN,IAAS,CAAlB;AACD;;AAEDD,QAAM,IAAIP,QAAQ,GAAG1C,oBAArB;AAEA,SAAOiD,MAAP;AAED,CAjBD,C,CAoBA;;;AACA,IAAM7B,KAAK,GAAG,SAARA,KAAQ,CAACH,KAAD,EAAW;AACvB,MAAIkC,QAAQ,GAAGzD,MAAM,GAAGC,MAAxB;;AAEA,MAAIsB,KAAK,CAACR,IAAN,IAAc,MAAlB,EAA0B;AACxB0C,YAAQ,IAAIV,kBAAkB,CAACxB,KAAD,CAA9B;AACD;;AAEDA,OAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBS,IAAI,CAACC,KAAL,CAAWG,QAAX,IAAuBtD,cAAvC;;AAEA,MAAIoB,KAAK,CAACR,IAAN,IAAc,MAAlB,EAA0B;AACxB,QAAI+B,eAAe,GAAGC,kBAAkB,CAACxB,KAAD,CAAxC;AACA,QAAIyB,QAAQ,GAAGzB,KAAK,CAAC0B,KAAN,CAAYD,QAA3B;AACA,QAAIE,SAAS,GAAGF,QAAQ,GAAG5C,cAA3B;AAEA,QAAIqD,SAAQ,GAAGlC,KAAK,CAACoB,KAAN,CAAYC,CAA3B;AACA,QAAIO,QAAQ,GAAG5B,KAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBE,eAAhB,GAAkCI,SAAjD;;AAEA,QAAIC,QAAQ,GAAC,CAAT,GAAa,GAAjB,EAAsB;AACpB5B,WAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBS,IAAI,CAACC,KAAL,CAAWG,SAAQ,GAAGN,QAAQ,GAAC,CAA/B,CAAhB;AACD,KAFD,MAEO;AACL5B,WAAK,CAACoB,KAAN,CAAYC,CAAZ,GAAgBS,IAAI,CAACC,KAAL,CAAWG,SAAQ,IAAI,IAAIN,QAAQ,GAAC,CAAjB,CAAnB,CAAhB;AACD;AACF;;AAEDhD,gBAAc,GAAG,CAAjB;AAED,CA1BD,C,CA4BA;;;AACA,IAAMyB,YAAY,GAAG,SAAfA,YAAe,CAACL,KAAD,EAAW;AAC9B,SAAOA,KAAK,CAACR,IAAN,IAAc,OAArB;AACD,CAFD;;AAIA,IAAMiB,WAAW,GAAG,SAAdA,WAAc,CAACT,KAAD,EAAW;AAC7B,SAAOA,KAAK,CAACR,IAAN,IAAc,MAArB;AACD,CAFD,C,CAIA;;;AACA,IAAMc,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB7B,QAAM,GAAG,CAAT;AACAC,QAAM,GAAG,CAAT;AACD,CAHD,C,CAKA;;;AACA,IAAMwB,UAAU,GAAG,SAAbA,UAAa,CAACF,KAAD,EAAW;AAC5B,MAAIA,KAAK,CAACe,IAAN,IAAcf,KAAK,CAACe,IAAN,CAAWoB,QAAX,CAAoB,OAApB,CAAlB,EAAgD;AAC9C1D,UAAM,GAAG,CAAT;AACAG,kBAAc,GAAG,CAAjB;AACD;AACF,CALD,C;;;;;;;;;;;ACtLA,mC","file":"my-command-2.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/my-command-2.js\");\n","import Sketch from 'sketch'\n\nlet bottom = 0, margin = 0;\n\nlet lastLayerIsText = false;\nlet baselineOffset = 0;\n\nconst capHeightRatio = 0.7\nconst baselineOffsetRatio = 0.17\nconst capHeightOffsetRatio = 0.13\n\n// Run the plugin\nexport default (context) => {\n  let doc = Sketch.fromNative(context.document)\n  let layers = doc ? doc.selectedLayers : null\n  layers = layers ? layers.layers : null\n\n  // is the seletion an artboard?\n  const isArtboard = layers && layers[0] && layers[0].type && layers[0].type == \"Artboard\" ? true : false\n\n  if (!isArtboard) {\n    Sketch.UI.message(\"Please select an artboard\")\n    return\n  }\n\n  // get the artboards layers\n  const artboard = layers[0]\n  layers = artboard.layers\n  \n  iterateLayers(layers)\n\n  // artboard.adjustToFit()\n  \n}\n\n\n// iterate over given array of layers\nconst iterateLayers = (layers) => {\n\n  layers.reverse()\n\n  let i = 0\n\n  while (i < layers.length) {\n\n    let layer = layers[i]\n\n    setMargin(layer)\n    checkIfTop(layer)\n    place(layer)\n    \n    let isGroup = checkIfGroup(layer)\n    \n    if (isGroup) {\n      setDefaults()\n      let groupLayers = layer.layers\n      iterateLayers(groupLayers)\n      layer.adjustToFit()\n    }\n\n    if (checkIfText(layer)) {\n      lastLayerIsText = true\n    } else if (checkIfGroup(layer)) {\n      lastLayerIsText = lastLayerIsText\n    } else {\n      lastLayerIsText = false\n    }\n\n    setBottom(layer, lastLayerIsText)\n    \n    i++\n\n  }\n\n  layers.reverse()\n\n}\n\nconst roundToNearest = (value, near) => {\n  if (value % near < 1) {\n    return value + (near - (value % near)) - near\n  } else {\n    return value + (near - (value % near))\n  }\n}\n\n// setting the margin value\nconst setMargin = (layer) => {\n  margin = getMargin(layer.name)\n}\n\nconst getMargin = (name) => {\n  let marginString = name.split(\"[margin:\")[1]\n  marginString = marginString ? marginString.split(\"]\")[0] : null\n  return Number(marginString) ? Number(marginString) : 0\n}\n\n// setting the bottom value\nconst setBottom = (layer, isText) => {\n\n  bottom = layer.frame.y + layer.frame.height\n\n  if (checkIfText(layer)) {\n    let capHeightOffset = getCapHeightOffset(layer)\n    let fontSize = layer.style.fontSize\n    let capHeight = fontSize * capHeightRatio\n    let baseline = capHeightOffset + capHeight\n    baselineOffset = layer.style.lineHeight - Math.round(baseline)\n  } else if (isText) {\n    baselineOffset = baselineOffset\n  } else {\n    bottom = layer.frame.y + layer.frame.height\n    baselineOffset = 0;\n  }\n\n}\n\nconst getCapHeightOffset = (layer) => {\n  let offset;\n\n  let fontSize = layer.style.fontSize\n  let lineHeight = layer.style.lineHeight\n\n  let diff = lineHeight - fontSize\n  if (diff%2 == 0) {\n    offset = diff/2\n  } else {\n    offset = (diff+1)/2\n  }\n\n  offset += fontSize * capHeightOffsetRatio\n\n  return offset\n\n}\n\n\n// place the layer based on current position and margin\nconst place = (layer) => {\n  let position = bottom + margin\n\n  if (layer.type == \"Text\") {\n    position -= getCapHeightOffset(layer)\n  }\n\n  layer.frame.y = Math.round(position) - baselineOffset\n\n  if (layer.type == \"Text\") {\n    let capHeightOffset = getCapHeightOffset(layer)\n    let fontSize = layer.style.fontSize\n    let capHeight = fontSize * capHeightRatio\n  \n    let position = layer.frame.y\n    let baseline = layer.frame.y + capHeightOffset + capHeight\n\n    if (baseline%4 < 1.2) {\n      layer.frame.y = Math.round(position - baseline%4)\n    } else {\n      layer.frame.y = Math.round(position + (4 - baseline%4))\n    }\n  }\n\n  baselineOffset = 0;\n\n}\n\n// check if the layer is a group\nconst checkIfGroup = (layer) => {\n  return layer.type == \"Group\"\n}\n\nconst checkIfText = (layer) => {\n  return layer.type == \"Text\"\n}\n\n// reset the position and margin to default (0)\nconst setDefaults = () => {\n  bottom = 0;\n  margin = 0;\n}\n\n// checks to see if the layer has is stuck to the top of its group\nconst checkIfTop = (layer) => {\n  if (layer.name && layer.name.includes(\"[top]\")) {\n    bottom = 0;\n    baselineOffset = 0;\n  }\n}","module.exports = require(\"sketch\");"],"sourceRoot":""}